var timerWorker,storage=localStorage;$(function(){function e(){void 0!==typeof Worker?(timerWorker=new Worker("dist/js/timer.min.js"),timerWorker.postMessage($("#duration_slider").val()),timerWorker.onmessage=function(e){var t=Math.floor(e.data/60),r=e.data%60,a=(10>t?"0"+t:t)+":"+(10>r?"0"+r:r);$("#task_timer").text(a),0===e.data&&(timerWorker.terminate(),$("#aBreak").prop("disabled",!1),o($("#task").val(),"task"))}):window.alert("Este navegador no soporta workers.")}function t(){void 0!==typeof Worker?(timerWorker=new Worker("dist/js/timer.min.js"),timerWorker.postMessage($("#break_slider").val()),timerWorker.onmessage=function(e){var t=Math.floor(e.data/60),r=e.data%60,a=(10>t?"0"+t:t)+":"+(10>r?"0"+r:r);$("#break_timer").text(a),0===e.data&&(timerWorker.terminate(),$("#newTask").prop("disabled",!1),o("Break","break"))}):window.alert("Este navegador no soporta workers.")}function r(e,t){var r;null===storage.getItem(e)?(r={duration:t,time:new Date},storage.setItem(e,JSON.stringify(r))):(r=JSON.parse(storage.getItem(e)),r.duration=parseInt(r.duration)+parseInt(t),r.time=new Date,storage.setItem(e,JSON.stringify(r)))}function a(){if(0!==storage.length){$("#record-container table tbody").empty(),$("#taskList").empty();for(var e=0;e<storage.length;e++){var t=storage.key(e),r=JSON.parse(storage.getItem(t)),a=new Date(r.time),o=(a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"/"+(a.getDate()<10?"0"+a.getDate():a.getDate())+"/"+a.getFullYear()+", "+(a.getHours()<10?"0"+a.getHours():a.getHours())+":"+(a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes())+":"+(a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds());$("#record-container table tbody").append('<tr><td class="mdl-data-table__cell--non-numeric">'+t+"</td><td>"+r.duration+"</td><td>"+o+"</td></tr>"),$("#taskList").append("<option value = "+t+">")}}}function o(e,t){if("granted"===Notification.permission){var r,a;"task"===t?(r=e,a={icon:"/dist/img/prueba.png",body:"The task '"+e+"' has finished. You deserve a break!",vibrate:[300,100,300]}):(r="Break",a={icon:"/dist/img/breakLogo.jpg",body:"Your break has finished. Back to work!",vibrate:[300,100,300]});var o=new Notification(r,a);setTimeout(function(){o.close()},1e4)}}Notification.requestPermission(),a(),$("#duration_slider").on("change",function(){var e=$(this).val();$("#duration").text(e+(e>1?" minutes":"minute"))}),$("#play").on("click",function(){0===$("#task").val().length?showDialog({title:"Error",text:"The task field is required",positive:{title:"Accept"}}):($("#primary").addClass("none"),$("#current_task").removeClass("none"),r($("#task").val(),$("#duration_slider").val()),e())}),$("#aBreak").on("click",function(){$("#current_task").addClass("none"),$("#break").removeClass("none"),$("#aBreak").prop("disabled",!0)}),$("#break_slider").on("change",function(){var e=$(this).val();$("#breakDuration").text(e+(e>1?" minutes":"minute"))}),$("#runBreak").on("click",function(){$("#break").addClass("none"),$("#current_break").removeClass("none"),t()}),$("#newTask").on("click",function(){a(),$("#current_break").addClass("none"),$("#primary").removeClass("none"),$("#newTask").prop("disabled",!0),$("#task").val("")})});